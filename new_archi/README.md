# DeFi 自动化交易基础设施
## 架构文档导读 (Architecture Overview)

> **文档类型：** 架构主文档 · 导读总览
> **版本：** v1.0 · 2026-02-26
> **维护方：** DeFi 策略团队

---

## §0.1 单一真相来源声明 (SSOT Declaration)

本文档体系遵循严格的**单一真相来源（Single Source of Truth）**原则，所有文档的主权边界如下：

| 文档类型 | 主权范围 | 位置 | 冲突裁决优先级 |
|---|---|---|---|
| **PRD 及附属文档** | 业务需求、评估指标定义、验证门控通过标准、策略生命周期状态定义 | `../prd/` 目录 | **最高**（不可被架构文档覆盖） |
| **本架构文档体系** | 技术实现方案、模块接口契约、数据库 Schema、部署配置 | 本目录 | 次之（描述"如何实现"，不重复定义"标准是什么"） |

**裁决规则：** 当架构文档与 PRD 发生冲突时，以 PRD 为准，并在架构文档中记录冲突原因和修复计划。任何修改 PRD 定义的行为须经团队审批。

---

## §0.2 版本管理策略 (Version Management)

### 文档版本规范

- **主版本（Major）**：架构发生结构性变化（如新增模块、删除模块、Zone 划分调整）
- **次版本（Minor）**：模块内部逻辑调整、接口变更、新增章节
- **修订版本（Patch）**：错别字、格式修正、注释补充

### 变更审批流

```
提出变更 → 创建变更说明（描述影响范围）
    ↓
确认是否影响 PRD 定义的指标或门控标准
    ├── 是 → 需 PRD 负责人 + 架构负责人双方审批
    └── 否 → 架构负责人单人审批即可
    ↓
更新文档版本号 → 更新本文档的版本记录表 → 合并
```

### 版本记录

| 版本 | 日期 | 变更内容 | 作者 |
|---|---|---|---|
| v1.0 | 2026-02-26 | 初始版本，从 18 份散乱文档重构而来 | DeFi 策略团队 |

---

## §0.3 端到端请求链路 (End-to-End Request Lifecycle)

> 本节描述**一笔交易从 AI 产生信号到链上确认**的完整路径，是理解整个系统的最短路径。
> 每个节点标注了对应的实现章节，可按需跳转。

### 正常执行路径

```
┌─────────────────────────────────────────────────────────────────┐
│  Zone A · 策略计算区 (Intelligence Zone)                         │
│                                                                 │
│  1. AI Strategy Agent 产生交易信号                               │
│     · 分配全局唯一 Trace ID (UUID v4)          → §6.1           │
│     · 记录当前水位线 last_seen_block           → §3.1           │
│     · 构造 TradeRequest (Protobuf)            → §2.1           │
│     · 通过 gRPC 发送至 Zone B                                   │
└──────────────────────┬──────────────────────────────────────────┘
                       │ gRPC (TradeRequest + Context)
                       ▼
┌─────────────────────────────────────────────────────────────────┐
│  Zone B · 模拟验证区 (Sandbox & Validation Zone)                 │
│                                                                 │
│  2. Sync Sentinel 水位线拦截                                     │
│     · 校验 CurrentBlock - last_sync_block                       │
│       ≤ [cfg: watermark_max_lag, 默认: 2 个区块]  → §3.1        │
│     · 不通过 → 返回 StaleDataError，终止流程                     │
│                                                                 │
│  3. 三源预言机校验 (Triple-Oracle Guard)                         │
│     · 聚合 Chainlink / TWAP / DEX Slot0       → §3.2           │
│     · 最大偏差 > [cfg: oracle_max_deviation_bps, 默认: 50 bps]  │
│       → 单次熔断，拒绝本笔交易                                    │
│                                                                 │
│  4. EVM 仿真执行 (Simulator)                                     │
│     · 基于 go-ethereum StateDB 在内存中执行    → §3.2           │
│     · 链下与链上计算结果位级对齐 (误差 = 0)                       │
│                                                                 │
│  5. 不变性断言校验 (Invariant Checker)                           │
│     · 执行策略声明的全部 invariants            → §3.2           │
│     · 任意一条断言失败 → 拦截，退回 SIMULATED                    │
│                                                                 │
│  6. FSM 状态推进                                                 │
│     INIT → SIMULATED → SIGNED                 → §3.3           │
│     · 原子事务：获取 Nonce 锁 + 更新状态 + 递增 Nonce            │
│                                                                 │
│  7. MEV 路由决策                                                 │
│     · 交易价值 > [cfg: mev_private_route_threshold, 默认: $1,000]│
│       → Flashbots 私有路由                    → §3.4            │
│     · 交易价值 ≤ 阈值 → 公共 Mempool                             │
│                                                                 │
│     FSM 推进：SIGNED → BROADCASTED                              │
└──────────────────────┬──────────────────────────────────────────┘
                       │ 签名请求 (仅 Hash 摘要，双向 TLS)
                       ▼
┌─────────────────────────────────────────────────────────────────┐
│  Zone C · 核心签名区 (Security Vault Zone)                       │
│                                                                 │
│  8. MPC 签名前置校验                                             │
│     · 白名单校验：目标合约地址是否在注册表内     → §5.1           │
│     · 函数选择器校验：调用方法是否在白名单内                       │
│     · 大额审批（STAGED 阶段）                   → §5.1           │
│       单笔 > [cfg: staged_approval_threshold, 默认: $10,000]    │
│       → 进入 PENDING_APPROVAL，等待管理员确认                    │
│     · 大额审批（LIVE 阶段）                                      │
│       单笔 > [cfg: live_approval_pct, 默认: 当前分配资金 15%]    │
│       → 同上                                                    │
│                                                                 │
│  9. MPC 分片签名，生成 Signed Payload                            │
└──────────────────────┬──────────────────────────────────────────┘
                       │ Signed Payload 返回 Zone B
                       ▼
┌─────────────────────────────────────────────────────────────────┐
│  Zone B · 链上广播与确认                                         │
│                                                                 │
│  10. 广播至链上                                                  │
│      · Flashbots Bundle / eth_sendRawTransaction → §3.4        │
│      · FSM 推进：BROADCASTED                                    │
│                                                                 │
│  11. 等待链上确认                                                 │
│      · 监听区块包含，达到安全确认数               → §3.3          │
│      · 超时未确认 → 触发阶梯 Gas 加速             → §3.3          │
│      · 检测到链重组 → FSM 回滚至 SIMULATED        → §3.3          │
│      · FSM 推进：CONFIRMED                                      │
│                                                                 │
│  12. 双分录对账写入                                               │
│      · 更新账本（debit/credit 分录）             → §4.1          │
│      · 更新资产余额快照（水位线写回）                              │
│                                                                 │
│  13. 可观测性闭环                                                 │
│      · 全链路 Trace ID 完成闭环                  → §6.1          │
│      · PnL 数据写入，触发 AI 反馈飞轮            → §6.4          │
└─────────────────────────────────────────────────────────────────┘
```

### 异常处理摘要

| 异常场景 | 发生位置 | 处理方式 | 详情 |
|---|---|---|---|
| 数据水位线滞后 | 步骤 2 | 返回 StaleDataError，终止本次请求 | §3.1 |
| 预言机价格偏差 | 步骤 3 | 单次熔断，不改变策略状态 | §3.2 |
| EVM 仿真失败 | 步骤 4 | 返回 SimulationError，记录详情 | §3.2 |
| 不变性断言破线 | 步骤 5 | 拦截，策略状态回退评估 | §3.2 |
| Nonce 冲突 | 步骤 6 | 行级锁保证串行，不产生冲突 | §3.3 |
| 进程崩溃恢复 | 任意步骤 | Recovery Manager 按状态自愈 | §3.3 |
| 大额交易挂起 | 步骤 8 | 进入 PENDING_APPROVAL 等待审批 | §5.1 |
| 链重组 | 步骤 11 | FSM 回滚，重新仿真评估 | §3.3 |
| 治理风险告警 | 后台持续 | 哨兵触发 FSM 熔断或提前撤资 | §5.2 |

---

## §0.4 验证门控实现导航表 (G1–G8 Implementation Map)

> **主权说明：** 门控的**通过标准**（数值阈值、判断逻辑）定义在 PRD 的《验证门控标准说明文档》中，本架构文档描述**如何实现**这些门控，两者缺一不可。

| 关卡 | 名称 | 流转区间 | 触发方式 | 架构实现章节 | 关键组件 |
|---|---|---|---|---|---|
| **G1** | 静态分析 | DRAFT → VALIDATED | 全自动 | §3.2 | AdapterRegistry 白名单校验 |
| **G2** | EVM 仿真精度 | DRAFT → VALIDATED | 全自动 | §3.2 + §08/Go仿真器 | StateDB 轻量仿真器 |
| **G3** | 不变性断言 | DRAFT → VALIDATED | 全自动 | §3.2 | InvariantChecker |
| **G4** | 极端 Fuzzing | DRAFT → VALIDATED | 全自动 | §3.2 + §7.2 | Anvil Fork + 压力注入 |
| **G5** | 历史回测 | VALIDATED → EVALUATED | 全自动 | §7.1 + §7.2 | BacktestProvider + 历史数据归档 |
| **G6** | 蒙特卡洛模拟 | VALIDATED → EVALUATED | 全自动 | §7.1 + §7.2 | IDataProvider 随机路径模拟 |
| **G7** | 影子模式对比 | SHADOWED → STAGED | 人工确认 | §3.1 + §3.3 | ShadowTrade gRPC + FSM 影子路径 |
| **G8** | Staged 生产验收 | STAGED → LIVE | 人工审批 | §5.1 + §3.3 | MPC 大额审批 + 管理员签字 |

---

## §0.5 文档索引 (Document Index)

### 架构文档（本体系）

| 编号 | 文档名称 | 一句话说明 | 主要读者 |
|---|---|---|---|
| **01** | **部署架构** | | |
| 1.1 | 三区网络拓扑 | Zone A/B/C 的物理隔离方案与通信规则 | DevOps、安全审计 |
| 1.2 | 容器资源配额 | Docker 容器的 CPU/内存/存储配置规格 | DevOps |
| 1.3 | 网络安全策略 | VPC、防火墙规则、TLS 配置 | DevOps、安全审计 |
| **02** | **数据总线与契约** | | |
| 2.1 | Protobuf 契约 | 所有跨模块通信的强类型接口定义 | 全体开发 |
| 2.2 | Redis Stream 实时管道 | L1–L4 数据流分层与多 Agent 消费架构 | 后端开发 |
| 2.3 | 多链数据统一规范 | 跨链时间基准、代币标识、Gas 折算规则 | 后端开发 |
| 2.4 | 历史数据归档 | ETL 管道、Parquet 存储、冷热分层 | 后端开发、回测工程师 |
| **03** | **核心执行引擎** | | |
| 3.1 | 策略 Agent 与水位线拦截 | Python Agent 基类 + Sync Sentinel 实现 | 策略开发、后端开发 |
| 3.2 | 验证层：EVM 仿真与预言机 | 三源预言机校验 + StateDB 仿真 + 不变性断言 | 后端开发 |
| 3.3 | 幂等状态机 FSM | 交易全生命周期状态流转 + Nonce 锁 + 自愈 | 后端开发 |
| 3.4 | MEV 路由与防夹执行 | Flashbots Bundle 构建与降级策略 | 后端开发 |
| 3.5 | 数据库 Schema 汇总 | 所有 PostgreSQL 表结构的统一参考 | 后端开发、DBA |
| **04** | **财务与结算** | | |
| 4.1 | 双分录会计系统 | 复式记账逻辑 + 跨链在途资金处理 | 后端开发、财务审计 |
| 4.2 | 资产估值与审计 | MtM 公允价值 + 软滑点 + 毒性流分析 | 后端开发、风控 |
| **05** | **安全防御** | | |
| 5.1 | MPC 签名与白名单拦截 | 分片签名架构 + 白名单 + 大额审批双阈值 | 安全工程师、后端开发 |
| 5.2 | 治理风险哨兵 | Snapshot/Tally 提案监控 + 熔断触发 | 后端开发、风控 |
| 5.3 | 全局断路器与时间锁 | Kill Switch + 24h 时间锁 + Guardian 机制 | 安全工程师、管理员 |
| **06** | **可观测性** | | |
| 6.1 | 全链路 Trace ID 规范 | Trace ID 生命周期 + 结构化日志格式 | 全体开发 |
| 6.2 | Prometheus 指标定义 | 系统关键指标的名称、类型、含义 | DevOps、后端开发 |
| 6.3 | 告警规则集 | 各级告警的触发条件与响应动作 | DevOps、运营 |
| 6.4 | AI 反馈飞轮 | 链上结果→评分→Prompt→策略迭代的闭环 | AI 工程师、策略开发 |
| **07** | **验证与回测** | | |
| 7.1 | 回测引擎与数据接口 | IDataProvider 接口 + BacktestProvider 实现 | 回测工程师、策略开发 |
| 7.2 | G1–G8 门控实现细节 | 每个关卡的技术实现，对齐 PRD 通过标准 | 后端开发、策略开发 |
| **08** | **参考实现** | | |
| 08/Go | Go 轻量仿真器原型 | 基于 StateDB 的 EVM 仿真器可运行代码 | 后端开发 |
| 08/Python | Python 策略 Agent 基类 | gRPC 客户端基类可运行代码 | 策略开发 |

### PRD 及附属文档（只读，指标主权）

| 文档名称 | 主要内容 | 架构文档的引用方式 |
|---|---|---|
| DeFi 自动化交易与资管基础设施 PRD | 系统目标、模块概述、非功能指标 | 整体设计依据 |
| 策略生命周期定义说明文档 | 8 状态定义、流转条件、资金权限 | §3.3 FSM 状态名称来源 |
| 验证门控标准说明文档 | G1–G8 通过标准与数值阈值 | §0.4 导航表 + §7.2 实现对齐 |
| 评估指标体系说明文档 | 25 个评估指标的计算口径 | §4.2 MtM + §6.4 AI 飞轮 |
| 数据基础设施规范 | 数据分层架构、访问接口、清洗规范 | §2.2 Redis + §7.1 回测 |
| 非功能性量化指标说明文档 | 延迟预算、可用性、吞吐量指标 | §6.2 Prometheus 指标定义依据 |
| 策略开发者旅程图 | 五阶段开发者体验流程 | §7.2 门控实现的用户视角参考 |

---

## §0.6 系统可配置参数汇总 (System Configuration Parameters)

> 本节汇总系统中所有可配置的关键参数。所有参数均有合理默认值，可在启动配置文件中覆盖。
> **调整原则：** 默认值经过生产验证，调整前须理解其影响范围；带 ⚠️ 标记的参数调整需经管理员审批，修改后须走时间锁生效流程（参见术语表：时间锁）。

### 风控与熔断参数

| 配置键 | 默认值 | 允许范围 | 说明 | 需时间锁 | 实现章节 |
|---|---|---|---|---|---|
| `watermark_max_lag` | `2` 个区块 | 1–10 | 水位线最大允许滞后，超出触发 StaleDataError | ⚠️ 是 | §3.1 |
| `oracle_max_deviation_bps` | `50` bps (0.5%) | 10–200 | 三源预言机最大允许价格偏差 | ⚠️ 是 | §3.2 |
| `invariant_max_drawdown_bps` | `100` bps (1%) | 10–500 | 单次执行最大允许 U 本位跌幅 | ⚠️ 是 | §3.2 |
| `invariant_max_slippage_bps` | `50` bps (0.5%) | 10–300 | 最大允许滑点 | ⚠️ 是 | §3.2 |
| `invariant_max_gas_multiple` | `3x` | 1.5x–10x | 实际 Gas 不得超过估算值的倍数 | ⚠️ 是 | §3.2 |

### 执行与路由参数

| 配置键 | 默认值 | 允许范围 | 说明 | 需时间锁 | 实现章节 |
|---|---|---|---|---|---|
| `mev_private_route_threshold` | `$1,000` | $0–无上限 | 高于此值走 Flashbots 私有路由，低于走公共 Mempool | 否 | §3.4 |
| `gas_acceleration_timeout_min` | `5` 分钟 | 1–30 | BROADCASTED 超时后触发阶梯 Gas 加速 | 否 | §3.3 |
| `gas_acceleration_pct` | `15%` | 5%–50% | 每次 Gas 加速的涨幅比例 | 否 | §3.3 |
| `tx_confirmation_blocks` | `3` 个区块 | 1–12 | 交易推进到 CONFIRMED 所需确认数 | 否 | §3.3 |
| `rpc_max_lag_blocks` | `2` 个区块 | 1–5 | RPC 节点落后主节点超过此值则切换备用节点 | 否 | §3.1 |

### 大额审批参数

| 配置键 | 默认值 | 允许范围 | 说明 | 需时间锁 | 实现章节 |
|---|---|---|---|---|---|
| `staged_approval_threshold` | `$10,000` | $1,000–无上限 | STAGED 阶段单笔触发人工审批的绝对金额阈值 | ⚠️ 是 | §5.1 |
| `live_approval_pct` | `15%` | 5%–50% | LIVE 阶段单笔触发人工审批的资金占比阈值 | ⚠️ 是 | §5.1 |
| `staged_max_position_pct` | `5%` | 1%–20% | STAGED 阶段最大持仓占全局资金池的比例 | ⚠️ 是 | §5.1 |

### 安全与治理参数

| 配置键 | 默认值 | 允许范围 | 说明 | 需时间锁 | 实现章节 |
|---|---|---|---|---|---|
| `admin_timelock_hours` | `24` 小时 | 6–72 | 全局风控参数修改的等待期（本身即时间锁机制，不适用策略流转） | — | §5.3 |
| `governance_scan_interval_sec` | `60` 秒 | 10–300 | 治理哨兵扫描提案的频率 | 否 | §5.2 |
| `shadow_mode_min_hours` | `72` 小时 | 24–168 | 影子模式最短运行时长（G7 门控） | ⚠️ 是 | §3.3 |
| `staged_min_days` | `7` 天 | 3–30 | STAGED 阶段最短验收时长（G8 门控） | ⚠️ 是 | §3.3 |

### 数据与归档参数

| 配置键 | 默认值 | 允许范围 | 说明 | 需时间锁 | 实现章节 |
|---|---|---|---|---|---|
| `price_stale_threshold_sec` | `30` 秒 | 5–120 | 预言机价格超过此时间戳视为过期 | 否 | §3.1 |
| `balance_stale_blocks` | `5` 个区块 | 1–20 | 余额数据滞后超过此值触发重新同步 | 否 | §3.1 |
| `redis_stream_maxlen` | `10,000` 条 | 1,000–100,000 | Redis Stream 保留的最大消息数（滚动窗口） | 否 | §2.2 |
| `archiver_batch_size` | `10,000` 条 | 1,000–50,000 | 归档服务每批写入 Parquet 的 Tick 数据量 | 否 | §2.4 |
| `archiver_flush_interval_sec` | `60` 秒 | 10–300 | 归档服务强制刷写间隔（防止数据积压） | 否 | §2.4 |

---

## §0.7 术语表 (Glossary)

> **使用规则：** 本文档体系中所有文档必须使用以下统一术语，括号内为历史别名（旧文档中出现，已废弃）。

### 系统分区术语

| 规范术语 | 英文 | 废弃别名 | 含义 |
|---|---|---|---|
| **策略计算区** | Intelligence Zone | 策略层、策略区、Zone A、VPC-A、Untrusted Zone | 运行 AI Agent 策略逻辑的网络区域 |
| **模拟验证区** | Sandbox & Validation Zone | 验证区、沙盒区、Zone B、VPC-B | 运行 EVM 仿真、FSM、预言机校验的网络区域 |
| **核心签名区** | Security Vault Zone | 签名区、金库区、Zone C、Bare Metal | 运行 MPC 签名节点的物理隔离区域 |

### 数据与时间术语

| 规范术语 | 英文 | 废弃别名 | 含义 |
|---|---|---|---|
| **数据水位线** | High Watermark | 水位线、水位、SyncBlock | 系统已成功同步到本地的最新链上区块高度 |
| **水位线拦截器** | Sync Sentinel | SyncSentinel、同步监控器、水位线监控 | 执行水位线校验并触发熔断的 Go 组件 |
| **水位线滞后** | Watermark Lag | 区块延迟、同步延迟 | CurrentBlock 与 last_sync_block 的差值（单位：区块） |
| **水位线熔断** | Stale Data Circuit Breaker | 硬熔断、物理熔断 | 水位线滞后超过阈值时触发的交易拦截动作 |
| **过期数据错误** | StaleDataError | 水位线错误、陈旧数据 | 水位线熔断时抛出的标准错误类型 |

### 价格与预言机术语

| 规范术语 | 英文 | 废弃别名 | 含义 |
|---|---|---|---|
| **三源预言机** | Triple-Oracle Guard | 三源价格、预言机卫兵、Oracle Guard | 聚合 Chainlink、TWAP、DEX Slot0 三个价格源的校验组件 |
| **预言机中位价** | Oracle Median Price | 中位价、决策价格 | 三个价格源的中位数，用于策略决策的唯一价格基准 |
| **预言机熔断** | Oracle Circuit Breaker | 价格熔断、预言机拦截 | 三源价格偏差超过阈值（0.5%）时触发的单次拦截动作 |
| **U 本位** | USD-Denominated | U 本位净值、USDC 计价 | 所有资产折算为 USDC 后的价值，消除代币价格波动影响 |

### 执行与状态术语

| 规范术语 | 英文 | 废弃别名 | 含义 |
|---|---|---|---|
| **幂等状态机** | Idempotent FSM | FSM、状态机、确定性执行引擎 | 管理单笔交易从 INIT 到 CONFIRMED 全生命周期的状态机 |
| **全链路追踪 ID** | Trace ID | trace_id、TraceID、追踪号 | 每笔交易从 AI 产生信号起分配的全局唯一标识（UUID v4） |
| **内部交易 ID** | Internal Tx ID | internal_tx_id、任务 ID | 数据库 trade_tasks 表的主键，与 tx_hash 一对一关联 |
| **Nonce 锁** | Nonce Lock Manager | nonce 管理器、Nonce 锁管理器 | 基于数据库行级锁实现的分布式 Nonce 分配组件 |
| **自愈管理器** | Recovery Manager | 恢复管理器、自愈扫描器 | 处理进程崩溃后未完成任务的后台恢复服务 |

### 安全与风控术语

| 规范术语 | 英文 | 废弃别名 | 含义 |
|---|---|---|---|
| **协议适配器注册表** | Adapter Registry | 适配器注册表、Adapter Registry | 管理所有链上协议适配器的中心化注册组件 |
| **合约白名单** | Contract Whitelist | 白名单、白名单合约 | MPC 签名前强制校验的允许目标合约地址列表 |
| **大额审批** | High-Value Approval | 人工审批、二次确认 | 单笔交易超过阈值时触发的管理员人工确认流程 |
| **治理风险哨兵** | Governance Sentinel | 治理哨兵、哨兵节点 | 监控链上治理提案并触发风险响应的组件 |
| **全局断路器** | Global Kill Switch | Kill Switch、一键撤销 | 紧急情况下一键撤销所有授权并停止所有交易的机制 |
| **时间锁** | Admin Timelock | 时间锁等待期、24h 锁 | 核心风控参数修改生效前的强制等待期。**适用范围：仅限全局风控参数修改**（如白名单变更、熔断阈值调整）；**不适用于策略状态流转**（STAGED→LIVE 等状态变更由链下管理员确认即可生效，不走时间锁）。默认等待期：`admin_timelock_hours`，可配置，见 §0.6 |

### 财务与会计术语

| 规范术语 | 英文 | 废弃别名 | 含义 |
|---|---|---|---|
| **双分录会计** | Double-Entry Ledger | 复式记账、双分录 | 每笔资产变动同时生成借方和贷方分录的金融级账本 |
| **公允价值估值** | Mark-to-Market (MtM) | MtM、市值估值、公允价值 | 基于三源预言机中位价实时重估资产价值 |
| **已实现收益** | Realized PnL | 已实现资产、已结算 | 交易 CONFIRMED 后写入账本的实际盈亏 |
| **未领取奖励** | Unclaimed Rewards | 未结算奖励、协议奖励 | 协议内积累但尚未领取的奖励代币 |
| **软滑点审计** | Soft Slippage Audit | 滑点审计、市场冲击审计 | 记录执行价与提议时市场价偏差的分析流程 |
| **毒性流** | Toxic Flow | 毒性流分析、被反向套利 | 策略发单后价格持续向不利方向移动的异常模式 |

### 策略生命周期术语

> 以下状态名称与 PRD《策略生命周期定义说明文档》完全一致，禁止使用别名。

| 规范状态名 | 含义 |
|---|---|
| **DRAFT** | 草稿：代码存在但未经任何系统验证 |
| **VALIDATED** | 已验证：通过 G1–G4 安全性关卡 |
| **EVALUATED** | 已评估：通过 G5–G6 绩效关卡 |
| **SHADOWED** | 影子运行：真实数据驱动但不发送交易 |
| **STAGED** | 预上线：使用真实小额资金灰度验证 |
| **LIVE** | 生产运行：全权运行，MPC 自动签名 |
| **PAUSED** | 暂停：临时中止，可恢复 |
| **DEPRECATED** | 已退役：终态，不可逆 |

---

## §0.8 阅读建议 (Reading Guide)

根据不同角色，建议的最短阅读路径：

**新加入的后端开发者：**
本文档（§0.3 端到端链路）→ §2.1 Protobuf 契约 → §3.3 幂等状态机 FSM → §3.5 数据库 Schema

**策略开发者：**
本文档（§0.3 + §0.4）→ §3.1 策略 Agent 基类 → §7.1 回测引擎 → §7.2 G1–G8 门控实现

**DevOps / 运维：**
本文档（§0.3 异常处理摘要）→ §1.1 三区网络拓扑 → §6.2 Prometheus 指标 → §6.3 告警规则集

**安全审计人员：**
本文档（§0.1 SSOT）→ §5.1 MPC 签名 → §5.2 治理哨兵 → §5.3 全局断路器 → §1.3 网络安全策略

---

*文档版本：v1.0 | 下一份文档：[1.1 三区网络拓扑](./01_部署架构/1.1_三区网络拓扑.md)*
